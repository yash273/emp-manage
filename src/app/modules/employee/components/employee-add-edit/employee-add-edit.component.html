<div class="top-container">
    <button mat-icon-button color="accent" (click)="drawer.toggle()" class="example-icon close-button">
        <mat-icon>menu</mat-icon>
    </button>
    <app-header></app-header>
</div>
<mat-drawer-container class="example-container" autosize>

    <mat-drawer #drawer class="sidenav" mode="side" opened>

        <app-sidebar></app-sidebar>

    </mat-drawer>
    <div class="user-wrapper">
        <mat-card class="user-card">
            <mat-card-header>
                <mat-card-title *ngIf="!userId">{{'employee.title.add' | translate}}</mat-card-title>
                <mat-card-title *ngIf="userId">{{'employee.title.edit' | translate}}</mat-card-title>
                <mat-card-subtitle>{{'employee.title.sub' | translate}} </mat-card-subtitle>
            </mat-card-header>
            <mat-card-content>
                <form [formGroup]="userForm">
                    <mat-form-field appearance="fill">
                        <mat-label>{{'employee.ff.first_name.label' | translate}}</mat-label>
                        <input matInput formControlName="first_name">
                        <mat-error *ngIf="userForm.get('first_name')?.hasError('required')">{{'employee.ff.first_name.error' | translate}}</mat-error>
                    </mat-form-field>
                    <mat-form-field appearance="fill">
                        <mat-label>{{'employee.ff.last_name.label' | translate}}</mat-label>
                        <input matInput formControlName="last_name">
                        <mat-error *ngIf="userForm.get('last_name')?.hasError('required')">{{'employee.ff.last_name.error' | translate}}</mat-error>
                    </mat-form-field>
                    <mat-form-field appearance="fill">
                        <mat-label>{{'employee.ff.mo.label' | translate}}</mat-label>
                        <input matInput formControlName="mobile">
                        <mat-error *ngIf="userForm.get('mobile')?.hasError('required')">{{'employee.ff.mo.error' | translate}}</mat-error>
                    </mat-form-field>
                    <mat-form-field appearance="fill">
                        <mat-label>{{'employee.ff.email.label' | translate}}</mat-label>
                        <input matInput formControlName="email">
                        <mat-error *ngIf="userForm.get('email')?.hasError('required')">{{'employee.ff.email.error' | translate}}</mat-error>
                    </mat-form-field>
                    <mat-form-field>
                        <mat-label>{{'employee.ff.role.label' | translate}}</mat-label>
                        <mat-select formControlName="role">
                            <mat-option value="1">{{'employee.ff.role.options.admin' | translate}}</mat-option>
                            <mat-option value="2">{{'employee.ff.role.options.employee' | translate}}</mat-option>
                        </mat-select>
                        <mat-error *ngIf="userForm.get('role')?.hasError('required')">{{'employee.ff.role.error' | translate}}</mat-error>
                    </mat-form-field>
                    <mat-form-field appearance="fill">
                        <mat-label>{{'employee.ff.password.label' | translate}}</mat-label>
                        <input matInput [type]="hide ? 'password' : 'text'" formControlName="password">
                        <button type="button" mat-icon-button matSuffix (click)="hide = !hide" [attr.aria-label]="'Hide password'"
                            [attr.aria-pressed]="hide">
                            <mat-icon>{{hide ? 'visibility_off' : 'visibility'}}</mat-icon>
                        </button>
                        <mat-error *ngIf="userForm.get('password')?.hasError('required')">{{'employee.ff.password.error' | translate}}</mat-error>
                        <mat-error *ngIf="userForm.get('password')?.hasError('pattern')">{{'employee.ff.password.pattern' | translate}}</mat-error>
                    </mat-form-field>
                    <mat-form-field appearance="fill" *ngIf="!userId">
                        <mat-label>{{'employee.ff.confirm_password.label' | translate}}</mat-label>
                        <input matInput [type]="hideConfirm ? 'password' : 'text'" formControlName="confirm_password">
                        <button type="button" mat-icon-button matSuffix (click)="hideConfirm = !hideConfirm" [attr.aria-label]="'Hide password'"
                            [attr.aria-pressed]="hideConfirm">
                            <mat-icon>{{hideConfirm ? 'visibility_off' : 'visibility'}}</mat-icon>
                        </button>
                        <mat-error *ngIf="userForm.get('confirm_password')?.hasError('passwordMismatch')">{{'employee.ff.confirm_password.error' |
                            translate}}</mat-error>
                    </mat-form-field>

                    <mat-form-field>
                        <mat-label>Date Of Birth</mat-label>
                        <input formControlName="dob" matInput [matDatepicker]="picker">
                        <mat-hint>{{selectedDateFormat | uppercase}}</mat-hint>
                        <mat-error *ngIf="userForm.get('dob')?.hasError('required')">{{'employee.ff.first_name.error' | translate}}</mat-error>
                        <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                        <mat-datepicker #picker></mat-datepicker>
                    </mat-form-field>

                    <div class="selection-div">
                        <mat-form-field appearance="fill">
                            <mat-label>{{'employee.ff.country.label' | translate}}</mat-label>
                            <mat-select formControlName="country" (selectionChange)="getStates(null)">
                                <mat-option *ngFor="let country of countries" [value]="country.id">
                                    {{ country.name }}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>

                        <mat-form-field appearance="fill">
                            <mat-label>{{'employee.ff.state.label' | translate}}</mat-label>
                            <mat-select formControlName="state" (selectionChange)="getCites(null)">
                                <mat-option *ngFor="let state of states" [value]="state.id">
                                    {{ state.name }}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>

                        <mat-form-field appearance="fill">
                            <mat-label>{{'employee.ff.city.label' | translate}}</mat-label>
                            <mat-select formControlName="city">
                                <mat-option *ngFor="let city of cities" [value]="city.id">
                                    {{ city.name }}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>

                    <section class="example-section">
                        <mat-label>{{'employee.ff.route.label' | translate}}</mat-label>
                        <div class="checkboxes-container">
                            <ng-container formGroupName="route_rights">
                                <ng-container *ngFor="let route of routes">
                                    <mat-checkbox [value]="route.id" [formControlName]="route.id">{{route.route}}</mat-checkbox>
                                </ng-container>
                            </ng-container>
                        </div>
                    </section>
                    <mat-card-actions>
                        <span>
                            <button *ngIf="!userId" mat-stroked-button color="primary" type="submit" (click)="addUser()">{{'employee.button.add' |
                                translate}}</button>
                            <button *ngIf="userId" mat-stroked-button color="primary" type="submit" (click)="EditUser()">{{'employee.button.edit' |
                                translate}}</button>
                            <button mat-stroked-button color="primary" type="button" routerLink="/employee">{{'employee.button.cancel' |
                                translate}}</button>
                        </span>
                    </mat-card-actions>
                </form>
            </mat-card-content>
        </mat-card>
    </div>
</mat-drawer-container>